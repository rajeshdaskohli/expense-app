<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<title>Expense Manager</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b0b0b">

<style>
*{box-sizing:border-box}
body{margin:0;font-family:Arial;background:#f4f4f4}

.topbar{
  background:#111;
  color:#fff;
  padding:14px;
  display:flex;
  align-items:center;
}

.container{
  max-width:540px;
  margin:0 auto;
  padding:14px;
}

.grid2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}

.card{
  background:#fff;
  border-radius:20px;
  padding:14px;
  text-align:center;
  cursor:pointer;
  border:1px solid #ddd;
}

.cardIcon{font-size:28px;margin-bottom:6px}

.page{display:none}
.page.active{display:block}

.box{
  background:#fff;
  border-radius:18px;
  padding:16px;
  margin-top:10px;
}

.lbl{font-weight:bold;display:block;margin:10px 0 4px}

.inp{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid #ccc;
}

.btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:#111;
  color:#fff;
  font-weight:bold;
  margin-top:10px;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="topbar">
  <h3 id="pageTitle">Home</h3>
</div>

<div class="container">

<!-- HOME PAGE -->
<div class="page active" id="pageHome">

  <div class="grid2">

    <div class="card" id="cardExpense">
      <div class="cardIcon">üí∞</div>
      <div class="cardTitle">Expense</div>
      <div class="cardSub">Finance Manager</div>
    </div>

  </div>

</div>


<!-- EXPENSE MENU -->
<div class="page" id="pageExpense">

  <div class="grid2">

    <div class="card" id="cardDashboard">
      <div class="cardIcon">üìä</div>
      <div class="cardTitle">Dashboard</div>
      <div class="cardSub">View Summary</div>
    </div>

    <div class="card" id="cardExpenseEntry">
      <div class="cardIcon">‚úçÔ∏è</div>
      <div class="cardTitle">Expense Entry</div>
      <div class="cardSub">Add Expense</div>
    </div>

    <div class="card" id="cardAddFund">
      <div class="cardIcon">‚ûï</div>
      <div class="cardTitle">Add Fund</div>
      <div class="cardSub">Manage Balance</div>
    </div>

  </div>

</div>


<!-- EXPENSE ENTRY PAGE -->
<div class="page" id="pageEntry">

<div class="box">

<label class="lbl">Expense Type</label>

<select class="inp" id="exp_type">
  <option value="">Select Type</option>
  <option>Bank</option>
  <option>Credit Card</option>
  <option>Cash</option>
</select>

<label class="lbl">Select Source</label>

<select class="inp" id="exp_source">
  <option value="">Select</option>
</select>

<label class="lbl">Amount</label>
<input class="inp" id="exp_amount" type="number"/>

<button class="btn" id="btnSaveExpense">
  Save Expense
</button>

</div>

</div>


<!-- ADD FUND PAGE -->
<div class="page" id="pageAddFund">

<div class="box">

<label class="lbl">Action Type</label>

<select class="inp" id="fund_action">
  <option value="">Select</option>
  <option value="add">Add Fund</option>
  <option value="paycc">Pay Credit Card Bill</option>
  <option value="payemi">Pay EMI</option>
</select>


<div id="addFundBox" style="display:none;">

<label class="lbl">Select Bank</label>
<select class="inp" id="fund_bank"></select>

<label class="lbl">Amount</label>
<input class="inp" id="fund_amount" type="number"/>

<button class="btn" id="btnAddFund">
  Add Fund
</button>

</div>


<div id="payCCBox" style="display:none;">

<label class="lbl">Credit Card</label>
<select class="inp" id="cc_list"></select>

<label class="lbl">Bank</label>
<select class="inp" id="bank_list"></select>

<label class="lbl">Amount</label>
<input class="inp" id="cc_amount" type="number"/>

<button class="btn" id="btnPayCC">
  Pay Bill
</button>

</div>


<div id="payEmiBox" style="display:none;">

<label class="lbl">Loan</label>
<select class="inp" id="loan_list"></select>

<label class="lbl">Bank</label>
<select class="inp" id="loan_bank"></select>

<label class="lbl">Amount</label>
<input class="inp" id="emi_amount" type="number"/>

<button class="btn" id="btnPayEmi">
  Pay EMI
</button>

</div>

</div>

</div>


<!-- DASHBOARD PAGE -->
<div class="page" id="pageDashboard">

<div class="box">

<h3>Dashboard</h3>

<div id="dashboardData">
Loading...
</div>

</div>

</div>

</div>


<script>

// ==== GOOGLE SHEET WEB APP URL ====
const API_URL = "PASTE_YOUR_GOOGLE_SCRIPT_URL";

async function apiPost(data){
  const r = await fetch(API_URL,{
    method:"POST",
    body: JSON.stringify(data)
  });
  return await r.json();
}


// PAGE NAVIGATION
function showPage(name){

  document.querySelectorAll(".page")
    .forEach(p=>p.classList.remove("active"));

  document.getElementById("page"+capitalize(name))
    .classList.add("active");

  pageTitle.textContent = capitalize(name);

  if(name=="Dashboard") loadDashboard();
}

function capitalize(s){
  return s.charAt(0).toUpperCase()+s.slice(1);
}


// CARD EVENTS
cardExpense.addEventListener("click", ()=>showPage("Expense"));
cardDashboard.addEventListener("click", ()=>showPage("Dashboard"));
cardExpenseEntry.addEventListener("click", ()=>showPage("Entry"));
cardAddFund.addEventListener("click", ()=>showPage("AddFund"));


// ACTION TYPE CHANGE
fund_action.addEventListener("change", function(){

  addFundBox.style.display="none";
  payCCBox.style.display="none";
  payEmiBox.style.display="none";

  if(this.value=="add") addFundBox.style.display="block";
  if(this.value=="paycc") payCCBox.style.display="block";
  if(this.value=="payemi") payEmiBox.style.display="block";

});


// SAVE EXPENSE
btnSaveExpense.addEventListener("click", async ()=>{

  let type = exp_type.value;
  let source = exp_source.value;
  let amount = exp_amount.value;

  if(!type || !source || !amount){
    alert("Fill all fields");
    return;
  }

  let r = await apiPost({
    action:"addExpense",
    type, source, amount
  });

  alert(r.message);

});


// ADD FUND
btnAddFund.addEventListener("click", async ()=>{

  let bank = fund_bank.value;
  let amount = fund_amount.value;

  let r = await apiPost({
    action:"addFund",
    bank, amount
  });

  alert(r.message);

});


// PAY CREDIT CARD
btnPayCC.addEventListener("click", async ()=>{

  let card = cc_list.value;
  let bank = bank_list.value;
  let amount = cc_amount.value;

  let r = await apiPost({
    action:"payCC",
    card, bank, amount
  });

  alert(r.message);

});


// PAY EMI
btnPayEmi.addEventListener("click", async ()=>{

  let loan = loan_list.value;
  let bank = loan_bank.value;
  let amount = emi_amount.value;

  let r = await apiPost({
    action:"payEMI",
    loan, bank, amount
  });

  alert(r.message);

});


// DASHBOARD LOAD
async function loadDashboard(){

  let r = await apiPost({
    action:"getDashboard"
  });

  dashboardData.innerHTML =
    "<pre>"+JSON.stringify(r,null,2)+"</pre>";

}

</script>

</body>
</html>
