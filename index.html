<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b0b0b">
  <title>Expense Manager</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
    body{margin:0;font-family:Arial,sans-serif;background:#f4f4f4;color:#111;}
    :root{ --border: rgba(0,0,0,0.12); --muted:#666; --text:#111; }
    .topbar{background:#111;color:#fff;padding:14px;display:flex;align-items:center;gap:12px;position:sticky;top:0;z-index:1000;}
    .menuBtn{width:44px;height:44px;border:none;border-radius:14px;background:transparent;color:#fff;font-size:22px;cursor:pointer;display:flex;align-items:center;justify-content:center;}
    .menuBtn:active{transform:scale(0.98);}
    .titleBox{display:flex;flex-direction:column;line-height:1.1;}
    .appTitle{font-weight:900;font-size:18px;}
    .appSub{font-weight:800;font-size:12px;opacity:0.85;letter-spacing:0.4px;}
    .container{max-width:540px;margin:0 auto;padding:18px;}
    .backSvg{width:30px;height:30px;}
    .backSvg path{stroke:#d9d9d9;stroke-width:2.2;stroke-linecap:round;stroke-linejoin:round;fill:none;}

    /* Drawer */
    .drawer-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.55);z-index:3000;opacity:0;visibility:hidden;pointer-events:none;transition:0.25s;}
    .drawer-overlay.show{opacity:1;visibility:visible;pointer-events:auto;}
    .drawer{width:280px;height:100%;background:#fff;position:absolute;left:0;top:0;transform:translateX(-110%);transition:0.25s;box-shadow:6px 0 25px rgba(0,0,0,0.25);padding:14px;}
    .drawer-overlay.show .drawer{transform:translateX(0);}
    .drawer-header{display:flex;align-items:center;justify-content:space-between;padding:8px 6px 14px;border-bottom:1px solid #eee;margin-bottom:10px;}
    .drawer-title{font-size:18px;font-weight:900;}
    .drawer-close{width:30px;height:30px;border:none;background:transparent;font-size:26px;font-weight:1000;cursor:pointer;}
    .drawer-link{display:block;padding:12px;border-radius:14px;text-decoration:none;color:#111;font-weight:800;margin:8px 0;background:#f5f5f5;border:1px solid rgba(0,0,0,0.08);}

    /* UI Components */
    .page{display:none;}
    .page.active{display:block;}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
    .card{background:#fff;border-radius:20px;padding:12px;height:120px;border:1.5px solid rgba(0,0,0,0.18);box-shadow:0 14px 30px rgba(0,0,0,0.08);cursor:pointer;transition:0.12s;text-align:center;display:flex;flex-direction:column;justify-content:center;}
    .card:active{transform:scale(0.98);}
    .cardIcon{font-size:28px;margin-bottom:10px;}
    .cardTitle{font-weight:900;font-size:16px;}
    .cardSub{font-weight:800;color:#666;font-size:13px;}
    .box{background:#fff;border-radius:18px;padding:16px;border:1px solid rgba(0,0,0,0.10);box-shadow:0 12px 26px rgba(0,0,0,0.06);margin-bottom:16px;}
    .field{margin-bottom:14px;}
    .lbl{display:block;font-size:15px;font-weight:900;margin-bottom:8px;}
    .inp{width:100%;height:54px;padding:0 14px;border-radius:14px;border:1px solid #d8d8d8;font-size:16px;outline:none;}
    .inp:focus{border-color:#111;}
    .sel{appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24'%3E%3Cpath fill='%23999' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;}
    .btn{height:56px;border:none;border-radius:16px;font-size:18px;font-weight:900;cursor:pointer;transition:0.12s;width:100%;}
    .btn:active{transform:scale(0.96); filter: brightness(0.9);}
    .btnBlack{background:#111;color:#fff;}
    .btnLight{background:#eef2ff;color:#111;border:1px solid rgba(0,0,0,0.10);}
    .toast{position:fixed;left:50%;bottom:22px;transform:translateX(-50%);background:#111;color:#fff;padding:12px 14px;border-radius:16px;font-weight:800;display:none;z-index:5000;}
    
    /* Dashboard Stats */
    .statRow{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid #eee;}
    .statRow:last-child{border:none;}
    .val-pos{color:green;font-weight:900;}
    .val-neg{color:red;font-weight:900;}
  </style>
</head>
<body>

  <div class="topbar">
    <button class="menuBtn" id="leftBtn">
      <span id="btnIcon">‚ò∞</span>
    </button>
    <div class="titleBox">
      <div class="appTitle" id="pageTitle">Home</div>
      <div class="appSub" id="pageSub">EXPENSE MANAGER</div>
    </div>
  </div>

  <div class="drawer-overlay" id="drawerOverlay">
    <div class="drawer">
      <div class="drawer-header">
        <div><div class="drawer-title">Menu</div></div>
        <button class="drawer-close" id="drawerClose">‚úï</button>
      </div>
      <a href="#" class="drawer-link" onclick="showPage('home')">üè† Home</a>
      <a href="#" class="drawer-link" onclick="showPage('expense')">üí∞ Expense Seva</a>
    </div>
  </div>

  <div class="container">
    <div class="page active" id="pageHome">
      <div class="grid2">
        <div class="card" onclick="showPage('expense')">
          <div class="cardIcon">üí∞</div>
          <div class="cardTitle">Expense Seva</div>
          <div class="cardSub">Manage Money</div>
        </div>
        <div class="card" style="opacity:0.5;">
          <div class="cardIcon">‚ûï</div>
          <div class="cardTitle">More</div>
          <div class="cardSub">Coming soon</div>
        </div>
      </div>
    </div>

    <div class="page" id="pageExpense">
      <div class="grid2">
        <div class="card" onclick="showPage('dashboard')">
          <div class="cardIcon">üìä</div>
          <div class="cardTitle">Dashboard</div>
          <div class="cardSub">View Balance</div>
        </div>
        <div class="card" onclick="showPage('entry')">
          <div class="cardIcon">‚úçÔ∏è</div>
          <div class="cardTitle">Expense Entry</div>
          <div class="cardSub">Spend Money</div>
        </div>
        <div class="card" onclick="showPage('addfund')">
          <div class="cardIcon">üè¶</div>
          <div class="cardTitle">Add Fund</div>
          <div class="cardSub">Pay Bill / EMI</div>
        </div>
      </div>
    </div>

    <div class="page" id="pageDashboard">
      <div class="box">
        <h3 style="margin-top:0;">üè¶ Bank Balance</h3>
        <div id="bankList"></div>
      </div>
      <div class="box">
        <h3 style="margin-top:0;">üí≥ Credit Cards</h3>
        <div id="cardList"></div>
      </div>
      <div class="box">
        <h3 style="margin-top:0;">üìâ Loans / EMI</h3>
        <div id="loanList"></div>
      </div>
    </div>

    <div class="page" id="pageEntry">
      <div class="box">
        <div class="field">
          <label class="lbl">Payment From</label>
          <select class="inp sel" id="expSource">
            <optgroup label="Banks" id="optBanks"></optgroup>
            <optgroup label="Cards" id="optCards"></optgroup>
            <option value="Cash">Cash</option>
          </select>
        </div>
        <div class="field">
          <label class="lbl">Amount</label>
          <input type="number" class="inp" id="expAmount" placeholder="Enter Amount">
        </div>
        <button class="btn btnBlack" onclick="saveExpense()">Submit Expense</button>
      </div>
    </div>

    <div class="page" id="pageAddfund">
      <div class="box">
        <div class="field">
          <label class="lbl">Select Action</label>
          <select class="inp sel" id="fundAction" onchange="toggleFundFields()">
            <option value="">-- Select --</option>
            <option value="add">Add Fund</option>
            <option value="cc">Pay Credit Card Bill</option>
            <option value="emi">Pay EMI</option>
          </select>
        </div>

        <div id="fieldCC" style="display:none;">
          <div class="field">
            <label class="lbl">Select Credit Card</label>
            <select class="inp sel" id="targetCC"></select>
          </div>
        </div>

        <div id="fieldEMI" style="display:none;">
          <div class="field">
            <label class="lbl">Select Loan</label>
            <select class="inp sel" id="targetLoan"></select>
          </div>
        </div>

        <div id="fieldBank" style="display:none;">
          <div class="field">
            <label class="lbl">Select Bank</label>
            <select class="inp sel" id="targetBank"></select>
          </div>
        </div>

        <div class="field" id="fieldAmt" style="display:none;">
          <label class="lbl">Amount</label>
          <input type="number" class="inp" id="fundAmount" placeholder="Enter Amount">
        </div>

        <button class="btn btnBlack" id="fundBtn" style="display:none;" onclick="processFund()">Submit</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // Initial Data (In future, fetch this from Google Sheets)
    let db = {
      banks: [
        { name: "SBI Bank", balance: 50000 },
        { name: "HDFC Bank", balance: 25000 }
      ],
      cards: [
        { name: "HDFC Regalia", due: 12000, billDate: "05 Feb" },
        { name: "ICICI Amazon", due: 5000, billDate: "10 Feb" }
      ],
      loans: [
        { name: "Home Loan", emi: 15000, status: "Pending" },
        { name: "Car Loan", emi: 8000, status: "Paid" }
      ],
      cash: 2000
    };

    function showToast(msg) {
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.style.display = "block";
      setTimeout(() => t.style.display = "none", 2000);
    }

    function showPage(name) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById('page' + name.charAt(0).toUpperCase() + name.slice(1)).classList.add('active');
      
      const title = document.getElementById("pageTitle");
      const sub = document.getElementById("pageSub");
      const btnIcon = document.getElementById("btnIcon");

      if(name === 'home') {
        title.textContent = "Home";
        sub.textContent = "EXPENSE MANAGER";
        btnIcon.textContent = "‚ò∞";
      } else {
        title.textContent = name.toUpperCase();
        btnIcon.innerHTML = `<svg class="backSvg" viewBox="0 0 24 24"><path d="M15 6 L9 12 L15 18"></path></svg>`;
      }
      
      if(name === 'dashboard') renderDashboard();
      if(name === 'entry') updateEntryDropdowns();
      if(name === 'addfund') updateFundDropdowns();
      
      document.getElementById("drawerOverlay").classList.remove("show");
    }

    // --- Dashboard Logic ---
    function renderDashboard() {
      const bList = document.getElementById("bankList");
      bList.innerHTML = db.banks.map(b => `
        <div class="statRow"><span>${b.name}</span><span class="val-pos">‚Çπ${b.balance}</span></div>
      `).join("") + `<div class="statRow"><span>Cash</span><span class="val-pos">‚Çπ${db.cash}</span></div>`;

      const cList = document.getElementById("cardList");
      cList.innerHTML = db.cards.map(c => `
        <div class="statRow">
          <div><b>${c.name}</b><br><small>Bill: ${c.billDate}</small></div>
          <span class="val-neg">‚Çπ${c.due}</span>
        </div>
      `).join("");

      const lList = document.getElementById("loanList");
      lList.innerHTML = db.loans.map(l => `
        <div class="statRow">
          <span>${l.name} (EMI)</span>
          <span class="${l.status==='Paid'?'val-pos':'val-neg'}">‚Çπ${l.emi} [${l.status}]</span>
        </div>
      `).join("");
    }

    // --- Expense Entry Logic ---
    function updateEntryDropdowns() {
      document.getElementById("optBanks").innerHTML = db.banks.map(b => `<option value="bank|${b.name}">${b.name}</option>`).join("");
      document.getElementById("optCards").innerHTML = db.cards.map(c => `<option value="card|${c.name}">${c.name}</option>`).join("");
    }

    function saveExpense() {
      const source = document.getElementById("expSource").value;
      const amt = parseFloat(document.getElementById("expAmount").value);
      if(!amt) return showToast("Enter valid amount");

      const [type, name] = source.split("|");
      if(type === "bank") {
        let b = db.banks.find(x => x.name === name);
        b.balance -= amt;
      } else if(type === "card") {
        let c = db.cards.find(x => x.name === name);
        c.due += amt;
      } else {
        db.cash -= amt;
      }
      showToast("Expense Recorded ‚úÖ");
      document.getElementById("expAmount").value = "";
    }

    // --- Add Fund / Pay Bill Logic ---
    function updateFundDropdowns() {
      document.getElementById("targetBank").innerHTML = db.banks.map(b => `<option value="${b.name}">${b.name}</option>`).join("");
      document.getElementById("targetCC").innerHTML = db.cards.map(c => `<option value="${c.name}">${c.name}</option>`).join("");
      document.getElementById("targetLoan").innerHTML = db.loans.map(l => `<option value="${l.name}">${l.name}</option>`).join("");
    }

    function toggleFundFields() {
      const act = document.getElementById("fundAction").value;
      const btn = document.getElementById("fundBtn");
      document.getElementById("fieldBank").style.display = (act==='cc'||act==='emi'||act==='add') ? "block" : "none";
      document.getElementById("fieldCC").style.display = (act==='cc') ? "block" : "none";
      document.getElementById("fieldEMI").style.display = (act==='emi') ? "block" : "none";
      document.getElementById("fieldAmt").style.display = act ? "block" : "none";
      btn.style.display = act ? "block" : "none";
      
      if(act==='add') btn.textContent = "Add Fund";
      else if(act==='cc') btn.textContent = "Pay Bill";
      else if(act==='emi') btn.textContent = "Pay EMI";
    }

    function processFund() {
      const act = document.getElementById("fundAction").value;
      const amt = parseFloat(document.getElementById("fundAmount").value);
      const bankName = document.getElementById("targetBank").value;
      
      if(!amt) return showToast("Enter amount");

      let bank = db.banks.find(x => x.name === bankName);

      if(act === 'add') {
        bank.balance += amt;
        showToast("Fund Added ‚úÖ");
      } 
      else if(act === 'cc') {
        let ccName = document.getElementById("targetCC").value;
        let cc = db.cards.find(x => x.name === ccName);
        bank.balance -= amt;
        cc.due -= amt;
        showToast("Bill Paid ‚úÖ");
      } 
      else if(act === 'emi') {
        let loanName = document.getElementById("targetLoan").value;
        let loan = db.loans.find(x => x.name === loanName);
        bank.balance -= amt;
        loan.status = "Paid";
        showToast("EMI Paid ‚úÖ");
      }

      document.getElementById("fundAmount").value = "";
      showPage('dashboard');
    }

    // Menu Toggle
    document.getElementById("leftBtn").onclick = () => {
      const activePage = document.querySelector('.page.active').id;
      if(activePage === 'pageHome') document.getElementById("drawerOverlay").classList.add("show");
      else showPage('home');
    };
    document.getElementById("drawerClose").onclick = () => document.getElementById("drawerOverlay").classList.remove("show");

  </script>
</body>
</html>
